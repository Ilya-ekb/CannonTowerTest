# CannonTower Test Project

### Описание

Проект реализует базовую механику стрельбы башни по движущимся целям с упреждением.  
В коде сохранены принципы чистоты, читаемости и расширяемости, без избыточной архитектуры.  
Используется **Object Pool**, предсказание траектории (`Predictive` / `Parabolic`), система перезарядки и обработка попаданий.

---

### Основная логика

- **Tower** — управляет поиском цели, прицеливанием, стрельбой и перезарядкой.  
- **Turret** — визуально поворачивает башню и ствол к цели.  
- **Projectile** — снаряд с гравитацией и временем жизни; возвращается в пул при столкновении или истечении времени.  
- **ProjectilePool** — управляет созданием и переиспользованием снарядов.  
- **Target (Monster)** — движущийся противник, реагирующий на попадания.  
- **Aiming Services** — два способа наведения:  
  - `PredictiveAimingService` — точное упреждение по скорости цели.  
  - `ParabolicAimingService` — траектория с гравитацией.  
- **Configs** — настройки башен и монстров через `ScriptableObject`.  
- **CooldownService** — простая система перезарядки выстрелов.

---

### Структура проекта

```
Scripts/
├── Configs/
│   ├── TowerConfig.cs          # параметры башни
│   └── MonsterConfig.cs        # параметры врага
├── Towers/
│   ├── Tower.cs                # логика стрельбы
│   └── Turret.cs               # визуальное наведение
├── Projectiles/
│   ├── Projectile.cs           # базовый снаряд
│   └── GuidedProjectile.cs     # управляемый (навидящий) снаряд
├── Monsters/
│   ├── Monster.cs              # враг
│   └── MonsterSpawner.cs       # спавн противников
├── Services/
│   ├── ProjectilePool.cs       # Object Pool
│   ├── CooldownService.cs      # перезарядка
│   └── Aiming/
│       ├── IAiming.cs
│       ├── PredictiveAimingService.cs
│       └── ParabolicAimingService.cs
└── MathUtils.cs
```

---

### Игровой цикл

1. Башня ищет ближайшую цель в радиусе (`Monster` / `Target`).  
2. Рассчитывается направление упреждения.  
3. Турель плавно поворачивается к цели.  
4. После совпадения угла (`aimThreshold`) башня стреляет.  
5. Снаряд летит, при столкновении вызывает `OnHit()` у цели.  
6. После попадания или по истечении времени возвращается в пул.

---

### Архитектура

- **SRP (Single Responsibility)** — каждая сущность отвечает за одну задачу.  
- **Object Pool** — минимизация аллокаций.  
- **Чистая декомпозиция** — логика, визуал и данные разделены.  
- **Простое расширение** — можно легко добавить новый тип башни, снаряда или цели.

---

### Различия от исходного тестового

- Убраны  слои абстракции и DI.  
- Поведение сосредоточено в одном контроллере `Tower.cs`.  
- Добавлена чистая обработка попаданий и возврат снарядов в пул.  
- Оптимизировано наведение и фильтрация целей.  
- Код стал короче и нагляднее.

---
